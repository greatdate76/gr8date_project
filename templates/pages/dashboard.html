{% extends "base.html" %}
{% load static %}
{% now 'U' as cachebust %}

{% block title %}Dashboard • GR8DATE{% endblock %}

{% block content %}
<div class="wrap">
  <section class="hero"><h1>Discover</h1></section>

  <section class="grid">
    {% for p in page_obj %}
      <a class="card" href="{% url 'pages:profile_detail' p.pk %}">
        <div class="avatar-wrap">
          {% if p.primary_image %}
            <img class="thumb" src="{{ p.primary_image.url }}" alt="{{ p.display_name }}">
          {% else %}
            {% with first=p.images.first %}
              {% if first and first.image %}
                <img class="thumb" src="{{ first.image.url }}" alt="{{ p.display_name }}">
              {% else %}
                <img class="thumb" src="{% static 'images/placeholders/profile-4x5.png' %}" alt="{{ p.display_name }}">
              {% endif %}
            {% endwith %}
          {% endif %}
        </div>
        <div class="body">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <strong>{{ p.display_name }}</strong>
            {% if p.age %}<span class="meta">{{ p.age }}</span>{% endif %}
          </div>
          <div class="meta">{% if p.location %}{{ p.location }}{% endif %}</div>
        </div>
      </a>
    {% empty %}
      <p>No profiles found.</p>
    {% endfor %}
  </section>

  {% if page_obj.paginator.num_pages > 1 %}
    <nav class="pagination" aria-label="Pagination">
      {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">« Prev</a>{% endif %}
      <span class="current">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Next »</a>{% endif %}
    </nav>
  {% endif %}
</div>

<style>
  :root { --bg:#f7f8fb; --panel:#fff; --panel-alt:#f0f3f8; --text:#101217; --muted:#5b6270; --border:#e6e6ef; }
  .wrap{max-width:1200px;margin:20px auto;padding:0 14px}
  .hero{background:linear-gradient(180deg,var(--panel),var(--panel-alt));border:1px solid var(--border);padding:14px;border-radius:16px;margin-bottom:14px}
  h1{margin:8px 0 14px}
  .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
  @media(max-width:1100px){.grid{grid-template-columns:repeat(3,1fr)}}
  @media(max-width:820px){.grid{grid-template-columns:repeat(2,1fr)}}
  @media(max-width:540px){.grid{grid-template-columns:1fr}}
  .card{background:#fff;border:1px solid var(--border);border-radius:16px;overflow:hidden;display:flex;flex-direction:column;transition:transform .15s, box-shadow .15s}
  .card:hover{transform:translateY(-2px);box-shadow:0 8px 22px rgba(0,0,0,.07)}
  .avatar-wrap{width:100%;aspect-ratio:4/5;border-radius:16px;overflow:hidden;border:1px solid #e6e6ef;background:#eef2f7}
  .thumb{width:100%;height:100%;object-fit:cover;display:block}
  .body{padding:10px 12px}
  .meta{color:var(--muted);font-size:.95rem}
  .pagination{display:flex;gap:10px;justify-content:center;align-items:center;margin:18px 0}
  .pagination a,.pagination span{padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:#fff;text-decoration:none;color:#111}
  .pagination .current{background:#111;color:#fff;border-color:#111}
</style>
{% endblock %}

